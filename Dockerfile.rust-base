FROM rust:1.77-bookworm

WORKDIR /app

COPY . .
ARG MAIN
RUN cargo build --release --bin $MAIN

FROM debian:bookworm-slim

COPY --from=0 /app/target/release/$MAIN /app

ENV RUST_BACKTRACE=1
CMD /app
